{% extends 'base.html' %}
{% block title %}Classes — Chronos{% endblock %}

{% block head %}
  {{ super() }}
  <link rel="stylesheet" href="{{ url_for('static', filename='css/classes.css') }}">
{% endblock %}

{% block content %}
<div class="accordion chronos-accordion" id="classesAccordion">
  <div class="accordion-item">
    <h2 class="accordion-header" id="classesCreateHeading">
      <button class="accordion-button collapsed bg-primary text-white" type="button" data-bs-toggle="collapse" data-bs-target="#classesCreate" aria-expanded="false" aria-controls="classesCreate">
        Nouvelle classe
      </button>
    </h2>
    <div id="classesCreate" class="accordion-collapse collapse" aria-labelledby="classesCreateHeading" data-bs-parent="#classesAccordion">
      <div class="accordion-body">
        <form method="post" class="vstack gap-3">
          <input type="hidden" name="form" value="create">
          <div>
            <label class="form-label">Nom</label>
            <input type="text" name="name" class="form-control" required>
          </div>
          <div>
            <label class="form-label">Effectif</label>
            <input type="number" name="size" class="form-control" min="1" value="20">
          </div>
          <div>
            <label class="form-label">Jours d'indisponibilité (YYYY-MM-DD, séparés par des virgules)</label>
            <textarea name="unavailable_dates" class="form-control" rows="2"></textarea>
          </div>
          <div>
            <label class="form-label">Notes</label>
            <textarea name="notes" class="form-control" rows="3"></textarea>
          </div>
          <button type="submit" class="btn btn-primary">Ajouter</button>
        </form>
      </div>
    </div>
  </div>
  <div class="accordion-item">
    <h2 class="accordion-header" id="classesListHeading">
      <button class="accordion-button bg-secondary text-white" type="button" data-bs-toggle="collapse" data-bs-target="#classesList" aria-expanded="true" aria-controls="classesList">
        Classes existantes
      </button>
    </h2>
    <div id="classesList" class="accordion-collapse collapse show" aria-labelledby="classesListHeading" data-bs-parent="#classesAccordion">
      <div class="accordion-body">
        <div class="table-responsive">
          <table class="table table-striped align-middle mb-0">
            <thead>
              <tr>
                <th>Nom</th>
                <th>Effectif</th>
                <th>Cours associés</th>
              </tr>
            </thead>
            <tbody>
              {% for class_group in class_groups %}
              <tr>
                <td>
                  <a href="{{ url_for('main.class_detail', class_id=class_group.id) }}">
                    {{ class_group.name }}
                  </a>
                </td>
                <td>{{ class_group.size }}</td>
                <td>{{ class_group.courses|length }}</td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
