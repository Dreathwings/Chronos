{% extends 'base.html' %}
{% block title %}Modifier la séance — {{ course.name }}{% endblock %}

{% block content %}
<div class="container py-4">
  <div class="row justify-content-center">
    <div class="col-xl-8 col-lg-10">
      <div class="card shadow-sm border-0">
        <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
          <span>Modifier la séance</span>
          <span class="badge bg-light text-primary">{{ course.course_type }}</span>
        </div>
        <div class="card-body">
          <div class="mb-4">
            <h5 class="fw-semibold mb-1">{{ course.name }}</h5>
            <div class="text-muted small">{{ attendee_labels | join(', ') }}</div>
            {% if subgroup_label %}
            <div class="text-muted small">Sous-groupe : {{ subgroup_label }}</div>
            {% endif %}
          </div>
          <form method="post" class="row g-3">
            <div class="col-md-6">
              <label class="form-label">Enseignant</label>
              <select class="form-select" name="teacher_id" {% if not teacher_options %}disabled{% endif %}>
                {% for teacher in teacher_options %}
                <option value="{{ teacher.id }}" {% if teacher.id|string == form_data.teacher_id|string %}selected{% endif %}>{{ teacher.name }}</option>
                {% endfor %}
              </select>
              {% if not teacher_options %}
              <div class="form-text text-danger">Aucun enseignant n'est associé au cours.</div>
              {% endif %}
            </div>
            <div class="col-md-6">
              <label class="form-label">Salle</label>
              <select class="form-select" name="room_id">
                {% for room in rooms %}
                <option value="{{ room.id }}" {% if room.id|string == form_data.room_id|string %}selected{% endif %}>{{ room.name }}</option>
                {% endfor %}
              </select>
            </div>
            <div class="col-md-4">
              <label class="form-label">Date</label>
              <input type="date" class="form-control" name="date" value="{{ form_data.date }}" required>
            </div>
            <div class="col-md-4">
              <label class="form-label">Heure de début</label>
              <select class="form-select" name="start_time">
                {% for start_time in start_times %}
                {% set value = start_time.strftime('%H:%M') %}
                <option value="{{ value }}" {% if value == form_data.start_time %}selected{% endif %}>{{ value }}</option>
                {% endfor %}
              </select>
            </div>
            <div class="col-md-4">
              <label class="form-label">Durée (heures)</label>
              <input type="number" class="form-control" name="duration" min="1" value="{{ form_data.duration }}">
            </div>
            <div class="col-12 text-end">
              <a href="{{ url_for('main.course_detail', course_id=course.id) }}" class="btn btn-outline-secondary">Annuler</a>
              <button type="submit" class="btn btn-primary" {% if not teacher_options %}disabled{% endif %}>Enregistrer</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
