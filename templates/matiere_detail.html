{% extends "base.html" %}
{% block content %}
<section class="two-columns">
  <div>
    <h2>{{ matiere.nom }}</h2>
    <p><strong>Description :</strong> {{ matiere.description or '—' }}</p>
    <p><strong>Durée :</strong> {{ matiere.duree }} minutes</p>
    <p><strong>Priorité :</strong> {{ matiere.priorite }}</p>
    <p><strong>Fenêtre :</strong>
      {% if matiere.fenetre_debut %}du {{ matiere.fenetre_debut.strftime('%d/%m/%Y') }}{% endif %}
      {% if matiere.fenetre_fin %} au {{ matiere.fenetre_fin.strftime('%d/%m/%Y') }}{% endif %}
    </p>
    <p><strong>Besoins :</strong> {{ matiere.besoins or '—' }}</p>

    <h3>Séances planifiées</h3>
    {% if cours %}
      <ul class="sessions">
        {% for session in cours %}
          <li>
            {{ session.date.strftime('%d/%m/%Y') }} — {{ session.debut.strftime('%H:%M') }} → {{ session.fin.strftime('%H:%M') }} :
            {% if session.enseignant %}{{ session.enseignant.nom }}{% else %}Enseignant non assigné{% endif %}
            {% if session.salle %} / {{ session.salle.nom }}{% endif %}
          </li>
        {% endfor %}
      </ul>
    {% else %}
      <p>Aucune séance planifiée pour le moment.</p>
    {% endif %}
  </div>
  <div>
    <h3>Modifier</h3>
    <form method="post" class="panel">
      <label for="nom">Nom</label>
      <input type="text" name="nom" id="nom" value="{{ matiere.nom }}" required>

      <label for="description">Description</label>
      <textarea name="description" id="description">{{ matiere.description }}</textarea>

      <div class="two-cols">
        <div>
          <label for="duree">Durée (min)</label>
          <input type="number" name="duree" id="duree" value="{{ matiere.duree }}" min="15" step="15">
        </div>
        <div>
          <label for="priorite">Priorité</label>
          <input type="number" name="priorite" id="priorite" value="{{ matiere.priorite }}" min="1">
        </div>
      </div>

      <label for="besoins">Besoins spécifiques</label>
      <textarea name="besoins" id="besoins">{{ matiere.besoins }}</textarea>

      <div class="two-cols">
        <div>
          <label for="fenetre_debut">Début possible</label>
          <input type="date" name="fenetre_debut" id="fenetre_debut" value="{{ matiere.fenetre_debut }}">
        </div>
        <div>
          <label for="fenetre_fin">Fin possible</label>
          <input type="date" name="fenetre_fin" id="fenetre_fin" value="{{ matiere.fenetre_fin }}">
        </div>
      </div>

      <button type="submit">Enregistrer</button>
    </form>
  </div>
</section>
<section>
  <h3>Calendrier du cours</h3>
  {% include "partials/calendar.html" with context %}
</section>
{% endblock %}
